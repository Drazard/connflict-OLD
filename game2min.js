var socket=io.connect();async function createMessage(e,t){let a=document.createElement("li");a.innerHTML=t;let n=document.getElementById(e);n.appendChild(a),n.scrollIntoView(!1);let s=n.getElementsByTagName("li"),c=s.length;for(;c>49;)await s[0].remove(),c=await s.length}setTimeout(()=>{socket.emit("chathistory","get me chat history plz!"),socket.emit("cmdhistory","get me cmd history plz!"),socket.emit("requestpage","temppage")},500),socket.onAny(async(e,t)=>{switch(e){case"unfreezecmd":document.getElementById("localterminal-input").style.display="block","chat-input"!=document.activeElement.id&&document.getElementById("localterminal-input").focus();break;case"cls":if("local_cmd"==t)return document.getElementById("localterminal-messages").innerHTML="";if("remote_cmd"==t)return document.getElementById("remoteterminal-messages").innerHTML="";break;case"redirect":window.location.href=t;break;case"chat":await createMessage("chat-messages",t),document.getElementById("chat-messages").scrollTop=1e4;break;case"cmd":await createMessage("localterminal-messages",t),console.log(t),document.getElementById("localterminal-messages").scrollTop=1e4;break;case"local_cmd":await createMessage("localterminal-messages",t),document.getElementById("localterminal-messages").scrollTop=1e4;break;case"remote_cmd":await createMessage("logs-messages",t),document.getElementById("logs-messages").scrollTop=1e4;break;case"keylog":case"log":console.log(t),await createMessage("logs-messages",t),document.getElementById("logs-messages").scrollTop=1e4;break;case"processwaiting":document.getElementById("processwaiting").innerHTML=t;break;case"servepage":document.getElementById("browser_content_iframe").srcdoc=t}});const newchat=document.getElementById("chat-input");newchat.addEventListener("keyup",async function(e){"Enter"===e.key&&newchat.value&&(await socket.emit("chat",newchat.value),newchat.value="")});const terminal_local=document.getElementById("localterminal-input");terminal_local.addEventListener("keyup",async function(e){"Enter"===e.key&&terminal_local.value&&(data={terminal:"local",command:terminal_local.value},socket.emit("process",data),terminal_local.value="",terminal_local.style.display="none")});const requestpage=document.getElementById("browser-input");function help(){alert("sorry, there is no help yet but soon")}requestpage.addEventListener("keyup",function(e){"Enter"===e.key&&socket.emit("requestpage",document.getElementById("browser-input").value)}),document.getElementById("localterminal-input").focus(),window.onmessage=(e=>{var t=e.data.event,a=e.data.data;socket.emit(t,a)});